<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Jobs finden â€“ JobBase</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Jobsuche</h1>
    <input type="text" id="searchInput" placeholder="Ort oder Titel">
    <button onclick="loadJobs()">Suchen</button>
    <div id="jobsList"></div>

    <script>
        const supabase = supabase.createClient("https://ytcrvruzmqjehnoaffda.supabase.co", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl0Y3J2cnV6bXFqZWhub2FmZmRhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ4MDc4NDUsImV4cCI6MjA2MDM4Mzg0NX0.gndc10XvC_Imyl3mPXb8EyXHKZiLAa3FHSn5J39qUB0");

        async function loadJobs() {
            const search = document.getElementById("searchInput").value;
            let query = supabase.from("jobs").select("*").order("created_at", { ascending: false });
            if (search) {
                query = query.ilike("title", `%{search}%`);
            }

            const { data, error } = await query;
            const list = document.getElementById("jobsList");
            list.innerHTML = "";

            if (error) {
                list.textContent = "Fehler: " + error.message;
                return;
            }

            if (data.length === 0) {
                list.textContent = "Keine Jobs gefunden.";
                return;
            }

            data.forEach(job => {
                const div = document.createElement("div");
                div.innerHTML = `<h3>{job.title}</h3><p>{job.location}</p><p>{job.description}</p><hr>`;
                list.appendChild(div);
            });
        }

        document.addEventListener("DOMContentLoaded", loadJobs);
    </script>
</body>
</html>
